!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("pako")):"function"==typeof define&&define.amd?define(["exports","pako"],factory):factory((global="undefined"!=typeof globalThis?globalThis:global||self).jwtJsDecode={},global.pako)}(this,(function(exports,pako){"use strict";const max=1e13;class Int10{buf;constructor(value){this.buf=[+value||0]}mulAdd(m,c){const b=this.buf,l=b.length;let i,t;for(i=0;i<l;++i)t=b[i]*m+c,t<max?c=0:t-=(c=0|t/max)*max,b[i]=t;c>0&&(b[i]=c)}sub(c){const b=this.buf,l=b.length;let i,t;for(i=0;i<l;++i)t=b[i]-c,t<0?(t+=max,c=1):c=0,b[i]=t;for(;0===b[b.length-1];)b.pop()}toString(base){if(10!=(base||10))throw"only base 10 is supported";const b=this.buf;let s=b[b.length-1].toString();for(let i=b.length-2;i>=0;--i)s+=(max+b[i]).toString().substring(1);return s}valueOf(){const b=this.buf;let v=0;for(let i=b.length-1;i>=0;--i)v=v*max+b[i];return v}simplify(){const b=this.buf;return 1==b.length?b[0]:this}}const UNSUPPORTED_ALGORITHM='Unsupported algorithm name specified! Supported algorithms: "HS256", "HS384", "HS512", "RS256", "RS384", "RS512" and "none".',ILLEGAL_ARGUMENT="Illegal argument specified!",CRYPTO_NOT_FOUND="Could not find 'crypto'.",PAKO_NOT_FOUND="Could not find 'pako'.",UNSUPPORTED_ZIP_TYPE="Unsupported zip type.";function generateErrorMessage(value,callee,argumentName="argument",defaultType="string"){let message=`Invalid argument passed to ${callee}.`;return typeof value!==defaultType?message+=` Expected type '${defaultType}', received '${typeof value}'.`:value?"argument"!==argumentName&&(message+=` Provided ${argumentName} is invalid.`):message+=` Provided ${argumentName} is empty.`,message}function cleanZeros(b){return 0===b[0]?cleanZeros(b.slice(1)):b}function hex2AB(hex){if(!hex)throw new Error(ILLEGAL_ARGUMENT);const match=hex.match(/[0-9A-F]{2}/gi);if(!match)throw new Error(ILLEGAL_ARGUMENT);return new Uint8Array(match.map((i=>parseInt(i,16))))}const reTimeS=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,reTimeL=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function stringCut(str,len){return str.length>len&&(str=str.substring(0,len)+"…"),str}class Stream{enc;pos;constructor(enc,pos=0){enc instanceof Stream?(this.enc=enc.enc,this.pos=enc.pos):(this.enc=enc,this.pos=pos)}get(pos){if(void 0===pos&&(pos=this.pos++),pos>=this.enc.length)throw"Requesting byte offset "+pos+" on a stream of length "+this.enc.length;return"string"==typeof this.enc?this.enc.charCodeAt(pos):this.enc[pos]}hexDigits="0123456789ABCDEF";hexByte(b){return this.hexDigits.charAt(b>>4&15)+this.hexDigits.charAt(15&b)}hexDump(start,end,raw){let s="";for(let i=start;i<end;++i)if(s+=this.hexByte(this.get(i)),!0!==raw)switch(15&i){case 7:s+="  ";break;case 15:s+="\n";break;default:s+=" "}return s}isASCII(start,end){for(let i=start;i<end;++i){const c=this.get(i);if(c<32||c>176)return!1}return!0}parseStringISO(start,end){let s="";for(let i=start;i<end;++i)s+=String.fromCharCode(this.get(i));return s}parseStringUTF(start,end){let s="";for(let i=start;i<end;){const c=this.get(i++);s+=c<128?String.fromCharCode(c):c>191&&c<224?String.fromCharCode((31&c)<<6|63&this.get(i++)):String.fromCharCode((15&c)<<12|(63&this.get(i++))<<6|63&this.get(i++))}return s}parseStringBMP(start,end){let hi,lo,str="";for(let i=start;i<end;)hi=this.get(i++),lo=this.get(i++),str+=String.fromCharCode(hi<<8|lo);return str}parseTime(start,end,shortYear){let s=this.parseStringISO(start,end);const m=(shortYear?reTimeS:reTimeL).exec(s);if(!m)return"Unrecognized time: "+s;if(shortYear){const y=+m[1]<70?2e3:1900;m[1]=y+""}return s=m[1]+"-"+m[2]+"-"+m[3]+" "+m[4],m[5]&&(s+=":"+m[5],m[6]&&(s+=":"+m[6],m[7]&&(s+="."+m[7]))),m[8]&&(s+=" UTC","Z"!=m[8]&&(s+=m[8],m[9]&&(s+=":"+m[9]))),s}parseInteger(start,end){let len,v=this.get(start),s="";const neg=v>127,pad=neg?255:0;for(;v==pad&&++start<end;)v=this.get(start);if(len=end-start,0===len)return neg?-1:0;if(len>4){let t=+v;for(len<<=3;0==(128&(t^pad));)t<<=1,--len;s="("+len+" bit)\n"}neg&&(v-=256);const n=new Int10(v);for(let i=start+1;i<end;++i)n.mulAdd(256,this.get(i));return s+n.toString()}parseBitString(start,end,maxLength){const unusedBit=this.get(start),intro="("+((end-start-1<<3)-unusedBit)+" bit)\n";let s="";for(let i=start+1;i<end;++i){const b=this.get(i),skip=i==end-1?unusedBit:0;for(let j=7;j>=skip;--j)s+=b>>j&1?"1":"0";if(s.length>maxLength)return intro+stringCut(s,maxLength)}return intro+s}parseOctetString(start,end,maxLength){if(this.isASCII(start,end))return stringCut(this.parseStringISO(start,end),maxLength);const len=end-start;let s="("+len+" byte)\n";len>(maxLength/=2)&&(end=start+maxLength);for(let i=start;i<end;++i)s+=this.hexByte(this.get(i));return len>maxLength&&(s+="…"),s}parseOID(start,end,maxLength){let s="",n=new Int10,bits=0;for(let i=start;i<end;++i){const v=this.get(i);if(n.mulAdd(128,127&v),bits+=7,!(128&v)){if(""===s)if(n=n.simplify(),n instanceof Int10)n.sub(80),s="2."+n.toString();else{const m=n<80?n<40?0:1:2;s=m+"."+(n-40*m)}else s+="."+n.toString();if(s.length>maxLength)return stringCut(s,maxLength);n=new Int10,bits=0}}return bits>0&&(s+=".incomplete"),s}}class ASN1{stream;header;length;tag;sub;constructor(stream,header,length,tag,sub){if(!(tag instanceof ASN1Tag))throw"Invalid tag value.";this.stream=stream,this.header=header,this.length=length,this.tag=tag,this.sub=sub}typeName(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}}content(maxLength){if(void 0===this.tag)return null;void 0===maxLength&&(maxLength=1/0);const content=this.posContent(),len=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(content,content+len,maxLength);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(content)?"false":"true";case 2:return this.stream.parseInteger(content,content+len);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(content,content+len,maxLength);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(content,content+len,maxLength);case 6:return this.stream.parseOID(content,content+len,maxLength);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return stringCut(this.stream.parseStringUTF(content,content+len),maxLength);case 18:case 19:case 20:case 21:case 22:case 26:return stringCut(this.stream.parseStringISO(content,content+len),maxLength);case 30:return stringCut(this.stream.parseStringBMP(content,content+len),maxLength);case 23:case 24:return this.stream.parseTime(content,content+len,23==this.tag.tagNumber)}return null}toString(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"}posStart(){return this.stream.pos}posContent(){return this.stream.pos+this.header}posEnd(){return this.stream.pos+this.header+Math.abs(this.length)}toHexString(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)}getHex(){return this.stream.hexDump(this.posContent(),this.posEnd(),!0)}getAB(clean=!0){return clean?cleanZeros(hex2AB(this.getHex())):hex2AB(this.getHex())}static decodeLength(stream){let buf=stream.get();const len=127&buf;if(len==buf)return len;if(len>6)throw"Length over 48 bits not supported at position "+(stream.pos-1);if(0===len)return null;buf=0;for(let i=0;i<len;++i)buf=256*buf+stream.get();return buf}static decode(stream){stream instanceof Stream||(stream=new Stream(stream,0));const streamStart=new Stream(stream),tag=new ASN1Tag(stream);let len=ASN1.decodeLength(stream),sub=null;const start=stream.pos,header=start-streamStart.pos,getSub=function(){if(sub=[],null!==len){const end=start+len;for(;stream.pos<end;)sub[sub.length]=ASN1.decode(stream);if(stream.pos!=end)throw"Content size is not correct for container starting at offset "+start}else try{for(;;){const s=ASN1.decode(stream);if(s.tag.isEOC())break;sub[sub.length]=s}len=start-stream.pos}catch(e){throw"Exception while decoding undefined length content: "+e}};if(tag.tagConstructed)getSub();else if(tag.isUniversal()&&(3==tag.tagNumber||4==tag.tagNumber))try{if(3==tag.tagNumber&&0!=stream.get())throw"BIT STRINGs with unused bits cannot encapsulate.";getSub();for(let i=0;i<sub.length;++i)if(sub[i].tag.isEOC())throw"EOC is not supposed to be actual content."}catch(e){sub=null}if(null===sub){if(null===len)throw"We can't skip over an invalid tag with undefined length at offset "+start;stream.pos=start+Math.abs(len)}return new ASN1(streamStart,header,len,tag,sub)}}class ASN1Tag{tagClass;tagConstructed;tagNumber;constructor(stream){let buf=stream.get();if(this.tagClass=buf>>6,this.tagConstructed=0!=(32&buf),this.tagNumber=31&buf,31==this.tagNumber){const n=new Int10;do{buf=stream.get(),n.mulAdd(128,127&buf)}while(128&buf);this.tagNumber=n.simplify()}}isUniversal(){return 0===this.tagClass}isEOC(){return 0===this.tagClass&&0===this.tagNumber}}const webCrypto="object"==typeof window&&(window.crypto||window.msCrypto),webCryptoSubtle=webCrypto&&(webCrypto.subtle||webCrypto.webkitSubtle||webCrypto.Subtle);class JwtSplit{header="";payload="";signature="";constructor(str,callee="JwtSplit"){if("string"!=typeof str)throw new Error(generateErrorMessage(str,callee,"JWT string"));this.fromString(str,callee)}fromString(str,callee="JwtSplit.fromString"){const jwtArr=str.split(".");if(3!==jwtArr.length)throw new Error(generateErrorMessage(str,callee,"JWT string"));const[header,payload,signature]=jwtArr;this.header=header,this.payload=payload,this.signature=signature}toString(){return this.header+"."+this.payload+"."+this.signature}}class JwtDecode{header={};payload={};signature="";constructor(str,callee="JwtDecode"){if("string"!=typeof str)throw new Error(generateErrorMessage(str,callee,"JWT string"));this.fromString(str,callee)}isGzip(){return isGzip(this.header)}fromString(str,callee="JwtDecode.fromString"){const jwtObj=jwtSplit(str,callee);jwtObj&&(this.header=jwtObj.header?s2J(bu2s(jwtObj.header)):{},this.payload=jwtObj.payload?this.isGzip()?s2J(zbu2s(jwtObj.payload)):s2J(bu2s(jwtObj.payload)):{},this.signature=jwtObj.signature||"")}toString(){return s2bu(J2s(this.header))+"."+(this.isGzip()?s2zbu(J2s(this.payload)):s2bu(J2s(this.payload)))+"."+this.signature}}function tryPromise(fn){try{return Promise.resolve(fn())}catch(e){return Promise.reject(e)}}function s2J(str){return JSON.parse(str)}function J2s(obj){return JSON.stringify(obj)}function b2s(str){if("undefined"!=typeof Buffer)return textDecode(Buffer.from(str,"base64"));if("undefined"!=typeof atob)return textDecode(atob(str));throw new Error(ILLEGAL_ARGUMENT)}function b2bu(str){if("string"!=typeof str||str.length%4!=0)throw new Error(ILLEGAL_ARGUMENT);return str.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function bu2b(str){if("string"!=typeof str||str.length%4==1)throw new Error(ILLEGAL_ARGUMENT);for(;str.length%4!=0;)str+="=";return str.replace(/-/g,"+").replace(/_/g,"/")}function bu2s(str){return b2s(bu2b(str))}function isGzip(header){return"object"==typeof header&&"string"==typeof header.zip&&"GZIP"===header.zip.toUpperCase()}function jwtDecode(str,callee="jwtDecode"){return new JwtDecode(str,callee)}const decodeJwt=jwtDecode,decode=jwtDecode;function jwtSplit(str,callee="jwtSplit"){return new JwtSplit(str,callee)}const splitJwt=jwtSplit,split=jwtSplit;function s2b(str){if("undefined"!=typeof Buffer)return Buffer.from(textEncode(str)).toString("base64");if("undefined"!=typeof btoa)return btoa(AB2s(textEncode(str)));throw new Error(ILLEGAL_ARGUMENT)}function s2bu(str){return b2bu(s2b(str))}function s2zbu(str,type="zlib"){return s2bu(zip(str,type))}function unzip(str){if("string"!=typeof str)throw new Error(ILLEGAL_ARGUMENT);if(pako&&(pako.inflate||pako.ungzip)){const buffer=s2U8A(str);let inflated;try{inflated=pako.inflate(buffer,{raw:!1})}catch{try{inflated=pako.ungzip(buffer,{raw:!1})}catch{throw new Error(UNSUPPORTED_ZIP_TYPE)}}return AB2s(inflated)}throw new Error(PAKO_NOT_FOUND)}function zbu2s(str){return textDecode(unzip(bu2s(str)))}function zip(str,type="zlib"){if("string"!=typeof str)throw new Error(ILLEGAL_ARGUMENT);if(pako&&(pako.deflate||pako.gzip)){let deflated;if("gzip"===type)deflated=pako.gzip(str,{raw:!1});else{if("zlib"!==type)throw new Error(UNSUPPORTED_ZIP_TYPE);deflated=pako.deflate(str,{raw:!1})}return AB2s(deflated)}throw new Error(PAKO_NOT_FOUND)}function s2U8A(str){const buff=new ArrayBuffer(str.length),view=new Uint8Array(buff);for(let i=0;i<str.length;i++)view[i]=str.charCodeAt(i);return view}function AB2s(buff){return buff instanceof Uint8Array||(buff=new Uint8Array(buff)),String.fromCharCode(...Array.from(buff))}async function createHmac(name,secret){if(webCryptoSubtle){const keyData=s2U8A(secret);return await webCryptoSubtle.importKey("raw",keyData,{name:"HMAC",hash:{name:name}},!0,["sign"]).then((key=>({update:async function(thing){return await webCryptoSubtle.sign("HMAC",key,s2U8A(thing))}})))}{const crypto=await import("crypto");return crypto&&crypto.createHmac?Promise.resolve(crypto.createHmac(name.replace("SHA-","sha"),secret)):Promise.reject(webCrypto)}}function algHSsign(bits){return async function(thing,secret){const hmac=await createHmac("SHA-"+bits,secret);return webCryptoSubtle?hmac?Promise.resolve(s2bu(AB2s(await hmac.update(thing)))):Promise.reject(ILLEGAL_ARGUMENT):Promise.resolve(b2bu(hmac.update(thing).digest("base64")))}}function algHSverify(bits){return async function(thing,signature,secret){return await algHSsign(bits)(thing,secret)===signature}}function s2pem(secret){if("string"!=typeof secret)throw new Error(ILLEGAL_ARGUMENT);let type="public";const lines=secret.split("\n"),ignoreLinesPriv=["-BEGIN RSA PRIVATE KEY-","-END RSA PRIVATE KEY-"],ignoreLinesPub=["-BEGIN RSA PUBLIC KEY-","-BEGIN PUBLIC KEY-","-END PUBLIC KEY-","-END RSA PUBLIC KEY-"],body=lines.map((line=>line.trim())).filter((line=>line.length&&function(line){return ignoreLinesPriv.some((ign=>line.toUpperCase().indexOf(ign)>-1))?(type="private",!1):!ignoreLinesPub.some((ign=>line.toUpperCase().indexOf(ign)>-1))}(line))).join("");if(body.length)return{body:s2U8A(b2s(bu2b(body))),type:type};throw new Error(ILLEGAL_ARGUMENT)}function pem2asn1(buff){if(!buff)throw new Error(ILLEGAL_ARGUMENT);buff instanceof ArrayBuffer&&(buff=new Uint8Array(buff));let asn1=ASN1.decode(buff);const res={};if(3===asn1.sub.length&&(asn1=asn1.sub[2].sub[0]),9===asn1.sub.length?(res.modulus=asn1.sub[1].getAB(),res.publicExponent=parseInt(asn1.sub[2].getHex(),16),res.privateExponent=asn1.sub[3].getAB(),res.prime1=asn1.sub[4].getAB(),res.prime2=asn1.sub[5].getAB(),res.exponent1=asn1.sub[6].getAB(),res.exponent2=asn1.sub[7].getAB(),res.coefficient=asn1.sub[8].getAB()):2===asn1.sub.length&&(asn1=asn1.sub[1].sub[0],res.modulus=asn1.sub[0].getAB(),res.publicExponent=parseInt(asn1.sub[1].getHex(),16)),res.bits=8*(res.modulus.length-1)+Math.ceil(Math.log(res.modulus[0]+1)/Math.log(2)),!res.bits)throw new Error(ILLEGAL_ARGUMENT);return res}function asn12jwk(asn1,type,extra){if(!asn1)throw new Error(ILLEGAL_ARGUMENT);if("private"===(type="string"==typeof type&&type.toLowerCase()||["public","private"][asn1.privateExponent?1:0])&&!asn1.privateExponent)throw new Error(ILLEGAL_ARGUMENT);let v=asn1.publicExponent;const expSize=Math.ceil(Math.log(v)/Math.log(256)),exp=new Uint8Array(expSize).map((function(el){return el=v%256,v=Math.floor(v/256),el})).reverse(),jwk=Object.assign({kty:"RSA"},extra,{n:s2bu(AB2s(asn1.modulus)),e:s2bu(AB2s(exp))});return"private"===type&&Object.assign(jwk,{d:s2bu(AB2s(asn1.privateExponent)),p:s2bu(AB2s(asn1.prime1)),q:s2bu(AB2s(asn1.prime2)),dp:s2bu(AB2s(asn1.exponent1)),dq:s2bu(AB2s(asn1.exponent2)),qi:s2bu(AB2s(asn1.coefficient))}),jwk}function pem2jwk(secret,type,extra){return tryPromise((()=>asn12jwk(pem2asn1(s2pem(secret).body),type,extra)))}async function createSign(name){if(webCryptoSubtle)return{update:function(thing){return{sign:async function(secret){return await pem2jwk(secret,"private",{key_ops:["sign"],alg:name.replace("SHA-","RS")}).then((async keyData=>await webCryptoSubtle.importKey("jwk",keyData,{name:"RSASSA-PKCS1-v1_5",hash:{name:name}},!0,["sign"]).then((async key=>await webCryptoSubtle.sign({name:"RSASSA-PKCS1-v1_5",hash:{name:name}},key,s2U8A(thing)).then(AB2s).then(s2b)))))}}}};{const crypto=await import("crypto");if(crypto&&crypto.createSign)return crypto.createSign(name.replace("SHA-","RSA-SHA"));throw new Error(CRYPTO_NOT_FOUND)}}function algRSsign(bits){return async function(thing,privateKey){try{const res=await createSign("SHA-"+bits);return b2bu(await res.update(thing).sign(privateKey,"base64"))}catch(e){return Promise.reject(e)}}}async function createVerify(name){if(webCryptoSubtle)return{update:function(thing){return{verify:async function(secret,signature){return await pem2jwk(secret,"public",{key_ops:["verify"],alg:name.replace("SHA-","RS")}).then((async({kty:kty,n:n,e:e})=>await webCryptoSubtle.importKey("jwk",{kty:kty,n:n,e:e},{name:"RSASSA-PKCS1-v1_5",hash:{name:name}},!1,["verify"]).then((async key=>await webCryptoSubtle.verify("RSASSA-PKCS1-v1_5",key,s2U8A(bu2s(signature)),s2U8A(thing))))))}}}};{const crypto=await import("crypto");if(crypto&&crypto.createVerify)return crypto.createVerify(name.replace("SHA-","RSA-SHA"));throw new Error(CRYPTO_NOT_FOUND)}}function algRSverify(bits){return async function(thing,signature,publicKey){try{signature=bu2b(signature);const rsaVerify=await createVerify("SHA-"+bits);return await rsaVerify.update(thing).verify(publicKey,signature,"base64")}catch(e){return Promise.reject(e)}}}async function algVerify(algorithm,thing,signature,secret){if("string"!=typeof algorithm||algorithm.length<4)throw new Error(UNSUPPORTED_ALGORITHM);const algo=algorithm.toLowerCase();if("none"===algo)return""===signature;const type=algo.slice(0,2),bits=parseInt(algo.slice(2));if(isNaN(bits)||[256,384,512].indexOf(bits)<0)throw new Error(UNSUPPORTED_ALGORITHM);switch(type){case"rs":return await algRSverify(bits)(thing,signature,secret);case"hs":return await algHSverify(bits)(thing,signature,secret);default:throw new Error(UNSUPPORTED_ALGORITHM)}}async function algSign(algorithm,thing,secret){if("string"!=typeof algorithm||algorithm.length<4)throw new Error(UNSUPPORTED_ALGORITHM);const algo=algorithm.toLowerCase();if("none"===algo)return"";const type=algo.slice(0,2),bits=parseInt(algo.slice(2));if(isNaN(bits)||[256,384,512].indexOf(bits)<0)throw new Error(UNSUPPORTED_ALGORITHM);switch(type){case"rs":return await algRSsign(bits)(thing,secret);case"hs":return await algHSsign(bits)(thing,secret);default:throw new Error(UNSUPPORTED_ALGORITHM)}}async function jwtVerify(jwtStr,secret){const jwt=jwtSplit(jwtStr,"jwtVerify"),header=s2J(bu2s(jwt.header)),thing=jwt.header+"."+jwt.payload;return tryPromise((()=>algVerify(header.alg,thing,jwt.signature,secret)))}const verifyJwt=jwtVerify,verify=jwtVerify;function jwtSign(jwtStr,secret){const jwt=jwtSplit(jwtStr,"jwtSign"),header=s2J(bu2s(jwt.header)),thing=jwt.header+"."+jwt.payload;return tryPromise((async()=>await algSign(header.alg,thing,secret)))}const signJwt=jwtSign,sign=jwtSign;async function jwtResign(jwtStr,secret,alg){const jwt=jwtDecode(jwtStr,"jwtResign");return alg&&(jwt.header.alg=alg),jwt.signature=await jwtSign(jwt.toString(),secret),jwt.toString()}const resignJwt=jwtResign,resign=jwtResign;function notLatin1String(str){return Array.prototype.some.apply(str,[str=>str.charCodeAt(0)>255])}function textEncode(input){if(notLatin1String(input)){const encoder=getTextEncoder();if(encoder)return encoder.encode(input)}return s2U8A(input)}function textDecode(input){if("string"==typeof input){try{const decoder=getTextDecoder("utf8",{fatal:!0});if(decoder)return decoder.decode(s2U8A(input))}catch{}return input}try{const decoder=getTextDecoder("utf8",{fatal:!0});if(decoder)return decoder.decode(input)}catch{}return input.toString("binary")}function getTextEncoder(){if("undefined"!=typeof TextEncoder)return new TextEncoder;if("undefined"!=typeof require){const encoder=require("util");if(void 0!==encoder?.TextEncoder)return new encoder.TextEncoder}return!1}function getTextDecoder(...args){if("undefined"!=typeof TextDecoder)return new TextDecoder(...args);if("undefined"!=typeof require){const decoder=require("util");if(void 0!==decoder?.TextDecoder)return new decoder.TextDecoder(...args)}return!1}exports.AB2s=AB2s,exports.Asn1Tag=class{tagClass=0;tagConstructed=!1;tagNumber=0;constructor(stream){const buf=stream.read();this.tagClass=buf>>6,this.tagConstructed=0!=(32&buf),this.tagNumber=31&buf}},exports.J2s=J2s,exports.JwtDecode=JwtDecode,exports.JwtSplit=JwtSplit,exports.algHSsign=algHSsign,exports.algHSverify=algHSverify,exports.algRSsign=algRSsign,exports.algRSverify=algRSverify,exports.algSign=algSign,exports.algVerify=algVerify,exports.asn12jwk=asn12jwk,exports.b2bu=b2bu,exports.b2s=b2s,exports.bu2b=bu2b,exports.bu2s=bu2s,exports.createHmac=createHmac,exports.createSign=createSign,exports.createVerify=createVerify,exports.cryptoType=async function(){const crypto=webCrypto||await import("crypto");return crypto?crypto.type||"crypto-node":"undefined"},exports.decode=decode,exports.decodeJwt=decodeJwt,exports.getTextDecoder=getTextDecoder,exports.getTextEncoder=getTextEncoder,exports.isGzip=isGzip,exports.jwtDecode=jwtDecode,exports.jwtResign=jwtResign,exports.jwtSign=jwtSign,exports.jwtSplit=jwtSplit,exports.jwtVerify=jwtVerify,exports.notLatin1String=notLatin1String,exports.pem2asn1=pem2asn1,exports.pem2jwk=pem2jwk,exports.resign=resign,exports.resignJwt=resignJwt,exports.s2AB=function(str){const buff=new ArrayBuffer(str.length),view=new Uint8Array(buff);for(let i=0;i<str.length;i++)view[i]=str.charCodeAt(i);return buff},exports.s2J=s2J,exports.s2U8A=s2U8A,exports.s2b=s2b,exports.s2bu=s2bu,exports.s2pem=s2pem,exports.s2zbu=s2zbu,exports.sign=sign,exports.signJwt=signJwt,exports.split=split,exports.splitJwt=splitJwt,exports.textDecode=textDecode,exports.textEncode=textEncode,exports.tryPromise=tryPromise,exports.unzip=unzip,exports.verify=verify,exports.verifyJwt=verifyJwt,exports.webCrypto=webCrypto,exports.webCryptoSubtle=webCryptoSubtle,exports.zbu2s=zbu2s,exports.zip=zip}));
