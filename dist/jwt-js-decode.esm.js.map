{"version":3,"file":"jwt-js-decode.esm.js","sources":["../src/int10.ts","../src/util.ts","../src/asn1.ts","../src/jwt-js-decode.ts"],"sourcesContent":["var max = 10000000000000; // biggest 10^n integer that can still fit 2^53 when multiplied by 256\r\n\r\nexport default class Int10 {\r\n    buf: any[];\r\n\r\n    constructor(value?) {\r\n        this.buf = [+value || 0];\r\n    }\r\n\r\n    mulAdd(m, c) {\r\n        // assert(m <= 256)\r\n        var b = this.buf,\r\n            l = b.length,\r\n            i, t;\r\n        for (i = 0; i < l; ++i) {\r\n            t = b[i] * m + c;\r\n            if (t < max)\r\n                c = 0;\r\n            else {\r\n                c = 0 | (t / max);\r\n                t -= c * max;\r\n            }\r\n            b[i] = t;\r\n        }\r\n        if (c > 0)\r\n            b[i] = c;\r\n    };\r\n\r\n    sub(c) {\r\n        // assert(m <= 256)\r\n        var b = this.buf,\r\n            l = b.length,\r\n            i, t;\r\n        for (i = 0; i < l; ++i) {\r\n            t = b[i] - c;\r\n            if (t < 0) {\r\n                t += max;\r\n                c = 1;\r\n            } else\r\n                c = 0;\r\n            b[i] = t;\r\n        }\r\n        while (b[b.length - 1] === 0)\r\n            b.pop();\r\n    };\r\n\r\n    toString(base?: number) {\r\n        if ((base || 10) != 10)\r\n            throw 'only base 10 is supported';\r\n        var b = this.buf,\r\n            s = b[b.length - 1].toString();\r\n        for (var i = b.length - 2; i >= 0; --i)\r\n            s += (max + b[i]).toString().substring(1);\r\n        return s;\r\n    };\r\n\r\n    valueOf() {\r\n        var b = this.buf,\r\n            v = 0;\r\n        for (var i = b.length - 1; i >= 0; --i)\r\n            v = v * max + b[i];\r\n        return v;\r\n    };\r\n\r\n    simplify() {\r\n        var b = this.buf;\r\n        return (b.length == 1) ? b[0] : this;\r\n    };\r\n}\r\n\r\nexport { Int10 };\r\n","export const UNSUPPORTED_ALGORITHM = 'Unsupported algorithm name specified! Supported algorithms: \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\" and \"none\".';\r\nexport const ILLEGAL_ARGUMENT = 'Illegal argument specified!';\r\nexport const CRYPTO_NOT_FOUND = 'Could not find \\'crypto\\'.';\r\nexport const PAKO_NOT_FOUND = 'Could not find \\'pako\\'.';\r\n\r\nexport function generateErrorMessage(value, callee, argumentName = 'argument', defaultType = 'string') {\r\n    let message = `Invalid argument passed to ${callee}.`;\r\n    if (typeof value !== defaultType) {\r\n        message += ` Expected type '${defaultType}', received '${typeof value}'.`\r\n    } else if (!value) {\r\n        message += ` Provided ${argumentName} is empty.`\r\n    } else if (argumentName !== 'argument') {\r\n        message += ` Provided ${argumentName} is invalid.`\r\n    }\r\n    return message;\r\n}\r\n\r\nexport function num2hex(memo: string, i: number): string {\r\n    return memo + ('0' + i.toString(16)).slice(-2);\r\n}\r\n\r\n// clean leading zeros\r\nexport function cleanZeros(b) {\r\n    return b[0] === 0 ? cleanZeros(b.slice(1)) : b;\r\n}\r\n\r\nexport function hex2AB(hex: string): ArrayBuffer | Uint8Array {\r\n    if (!hex) throw new Error(ILLEGAL_ARGUMENT);\r\n    const match = hex.match(/[0-9A-F]{2}/ig);\r\n    if (!match) throw new Error(ILLEGAL_ARGUMENT);\r\n    return new Uint8Array(match.map(i => parseInt(i, 16)))\r\n}\r\n\r\nexport function AB2hex(buff: ArrayBuffer | Uint8Array): string {\r\n    if (buff instanceof ArrayBuffer) buff = new Uint8Array(buff);\r\n    return (buff as Uint8Array).reduce(num2hex, '');\r\n}\r\n","import { Int10 } from './int10';\r\nimport { cleanZeros, hex2AB } from \"./util\";\r\n\r\nconst ellipsis = \"\\u2026\",\r\n    reTimeS = /^(\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/,\r\n    reTimeL = /^(\\d\\d\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/;\r\n\r\nfunction stringCut(str, len) {\r\n    if (str.length > len)\r\n        str = str.substring(0, len) + ellipsis;\r\n    return str;\r\n}\r\n\r\nexport class Stream {\r\n    enc: any;\r\n    pos: any;\r\n\r\n    constructor(enc, pos = 0) {\r\n        if (enc instanceof Stream) {\r\n            this.enc = enc.enc;\r\n            this.pos = enc.pos;\r\n        } else {\r\n            this.enc = enc;\r\n            this.pos = pos;\r\n        }\r\n    }\r\n\r\n    get(pos) {\r\n        if (pos === undefined)\r\n            pos = this.pos++;\r\n        if (pos >= this.enc.length)\r\n            throw 'Requesting byte offset ' + pos + ' on a stream of length ' + this.enc.length;\r\n        return (typeof this.enc == \"string\") ? this.enc.charCodeAt(pos) : this.enc[pos];\r\n    };\r\n\r\n    hexDigits = \"0123456789ABCDEF\";\r\n\r\n    hexByte(b) {\r\n        return this.hexDigits.charAt((b >> 4) & 0xF) + this.hexDigits.charAt(b & 0xF);\r\n    };\r\n\r\n    hexDump(start, end, raw) {\r\n        var s = \"\";\r\n        for (var i = start; i < end; ++i) {\r\n            s += this.hexByte(this.get(i));\r\n            if (raw !== true)\r\n                switch (i & 0xF) {\r\n                    case 0x7:\r\n                        s += \"  \";\r\n                        break;\r\n                    case 0xF:\r\n                        s += \"\\n\";\r\n                        break;\r\n                    default:\r\n                        s += \" \";\r\n                }\r\n        }\r\n        return s;\r\n    };\r\n\r\n    isASCII(start, end) {\r\n        for (var i = start; i < end; ++i) {\r\n            var c = this.get(i);\r\n            if (c < 32 || c > 176)\r\n                return false;\r\n        }\r\n        return true;\r\n    };\r\n\r\n    parseStringISO(start, end) {\r\n        var s = \"\";\r\n        for (var i = start; i < end; ++i)\r\n            s += String.fromCharCode(this.get(i));\r\n        return s;\r\n    };\r\n\r\n    parseStringUTF(start, end) {\r\n        var s = \"\";\r\n        for (var i = start; i < end;) {\r\n            var c = this.get(i++);\r\n            if (c < 128)\r\n                s += String.fromCharCode(c);\r\n            else if ((c > 191) && (c < 224))\r\n                s += String.fromCharCode(((c & 0x1F) << 6) | (this.get(i++) & 0x3F));\r\n            else\r\n                s += String.fromCharCode(((c & 0x0F) << 12) | ((this.get(i++) & 0x3F) << 6) | (this.get(i++) & 0x3F));\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseStringBMP(start, end) {\r\n        var str = \"\", hi, lo;\r\n        for (var i = start; i < end;) {\r\n            hi = this.get(i++);\r\n            lo = this.get(i++);\r\n            str += String.fromCharCode((hi << 8) | lo);\r\n        }\r\n        return str;\r\n    };\r\n\r\n    parseTime(start, end, shortYear) {\r\n        var s = this.parseStringISO(start, end),\r\n            m = (shortYear ? reTimeS : reTimeL).exec(s);\r\n        if (!m)\r\n            return \"Unrecognized time: \" + s;\r\n        if (shortYear) {\r\n            var t = +m[1], y = (t < 70) ? 2000 : 1900;\r\n            m[1] = y + \"\";\r\n        }\r\n        s = m[1] + \"-\" + m[2] + \"-\" + m[3] + \" \" + m[4];\r\n        if (m[5]) {\r\n            s += \":\" + m[5];\r\n            if (m[6]) {\r\n                s += \":\" + m[6];\r\n                if (m[7])\r\n                    s += \".\" + m[7];\r\n            }\r\n        }\r\n        if (m[8]) {\r\n            s += \" UTC\";\r\n            if (m[8] != 'Z') {\r\n                s += m[8];\r\n                if (m[9])\r\n                    s += \":\" + m[9];\r\n            }\r\n        }\r\n        return s;\r\n    };\r\n\r\n    parseInteger(start, end) {\r\n        var v = this.get(start),\r\n            neg = (v > 127),\r\n            pad = neg ? 255 : 0,\r\n            len,\r\n            s = '';\r\n        while (v == pad && ++start < end)\r\n            v = this.get(start);\r\n        len = end - start;\r\n        if (len === 0)\r\n            return neg ? -1 : 0;\r\n        if (len > 4) {\r\n            let t = +v;\r\n            len <<= 3;\r\n            while (((t ^ pad) & 0x80) === 0) {\r\n                t <<= 1;\r\n                --len;\r\n            }\r\n            s = \"(\" + len + \" bit)\\n\";\r\n        }\r\n        if (neg) v = v - 256;\r\n        const n = new Int10(v);\r\n        for (let i = start + 1; i < end; ++i)\r\n            n.mulAdd(256, this.get(i));\r\n        return s + n.toString();\r\n    };\r\n\r\n    parseBitString(start, end, maxLength) {\r\n        var unusedBit = this.get(start),\r\n            lenBit = ((end - start - 1) << 3) - unusedBit,\r\n            intro = \"(\" + lenBit + \" bit)\\n\",\r\n            s = \"\";\r\n        for (var i = start + 1; i < end; ++i) {\r\n            var b = this.get(i),\r\n                skip = (i == end - 1) ? unusedBit : 0;\r\n            for (var j = 7; j >= skip; --j)\r\n                s += (b >> j) & 1 ? \"1\" : \"0\";\r\n            if (s.length > maxLength)\r\n                return intro + stringCut(s, maxLength);\r\n        }\r\n        return intro + s;\r\n    };\r\n\r\n    parseOctetString(start, end, maxLength) {\r\n        if (this.isASCII(start, end))\r\n            return stringCut(this.parseStringISO(start, end), maxLength);\r\n        var len = end - start,\r\n            s = \"(\" + len + \" byte)\\n\";\r\n        maxLength /= 2;\r\n        if (len > maxLength)\r\n            end = start + maxLength;\r\n        for (var i = start; i < end; ++i)\r\n            s += this.hexByte(this.get(i));\r\n        if (len > maxLength)\r\n            s += ellipsis;\r\n        return s;\r\n    };\r\n\r\n    parseOID(start, end, maxLength) {\r\n        var s = '',\r\n            n = new Int10(),\r\n            bits = 0;\r\n        for (var i = start; i < end; ++i) {\r\n            var v = this.get(i);\r\n            n.mulAdd(128, v & 0x7F);\r\n            bits += 7;\r\n            if (!(v & 0x80)) {\r\n                if (s === '') {\r\n                    n = n.simplify();\r\n                    if (n instanceof Int10) {\r\n                        n.sub(80);\r\n                        s = \"2.\" + n.toString();\r\n                    } else {\r\n                        var m = n < 80 ? n < 40 ? 0 : 1 : 2;\r\n                        s = m + \".\" + (n - m * 40);\r\n                    }\r\n                } else\r\n                    s += \".\" + n.toString();\r\n                if (s.length > maxLength)\r\n                    return stringCut(s, maxLength);\r\n                n = new Int10();\r\n                bits = 0;\r\n            }\r\n        }\r\n        if (bits > 0)\r\n            s += \".incomplete\";\r\n        return s;\r\n    };\r\n}\r\n\r\nexport class ASN1 {\r\n    stream: any;\r\n    header: any;\r\n    length: any;\r\n    tag: any;\r\n    sub: any;\r\n\r\n    constructor(stream, header, length, tag, sub) {\r\n        if (!(tag instanceof ASN1Tag)) throw 'Invalid tag value.';\r\n        this.stream = stream;\r\n        this.header = header;\r\n        this.length = length;\r\n        this.tag = tag;\r\n        this.sub = sub;\r\n    }\r\n\r\n    typeName() {\r\n        switch (this.tag.tagClass) {\r\n            case 0: \r\n                switch (this.tag.tagNumber) {\r\n                    case 0x00:\r\n                        return \"EOC\";\r\n                    case 0x01:\r\n                        return \"BOOLEAN\";\r\n                    case 0x02:\r\n                        return \"INTEGER\";\r\n                    case 0x03:\r\n                        return \"BIT_STRING\";\r\n                    case 0x04:\r\n                        return \"OCTET_STRING\";\r\n                    case 0x05:\r\n                        return \"NULL\";\r\n                    case 0x06:\r\n                        return \"OBJECT_IDENTIFIER\";\r\n                    case 0x07:\r\n                        return \"ObjectDescriptor\";\r\n                    case 0x08:\r\n                        return \"EXTERNAL\";\r\n                    case 0x09:\r\n                        return \"REAL\";\r\n                    case 0x0A:\r\n                        return \"ENUMERATED\";\r\n                    case 0x0B:\r\n                        return \"EMBEDDED_PDV\";\r\n                    case 0x0C:\r\n                        return \"UTF8String\";\r\n                    case 0x10:\r\n                        return \"SEQUENCE\";\r\n                    case 0x11:\r\n                        return \"SET\";\r\n                    case 0x12:\r\n                        return \"NumericString\";\r\n                    case 0x13:\r\n                        return \"PrintableString\"; \r\n                    case 0x14:\r\n                        return \"TeletexString\"; \r\n                    case 0x15:\r\n                        return \"VideotexString\";\r\n                    case 0x16:\r\n                        return \"IA5String\"; \r\n                    case 0x17:\r\n                        return \"UTCTime\";\r\n                    case 0x18:\r\n                        return \"GeneralizedTime\";\r\n                    case 0x19:\r\n                        return \"GraphicString\";\r\n                    case 0x1A:\r\n                        return \"VisibleString\"; \r\n                    case 0x1B:\r\n                        return \"GeneralString\";\r\n                    case 0x1C:\r\n                        return \"UniversalString\";\r\n                    case 0x1E:\r\n                        return \"BMPString\";\r\n                }\r\n                return \"Universal_\" + this.tag.tagNumber.toString();\r\n            case 1:\r\n                return \"Application_\" + this.tag.tagNumber.toString();\r\n            case 2:\r\n                return \"[\" + this.tag.tagNumber.toString() + \"]\"; \r\n            case 3:\r\n                return \"Private_\" + this.tag.tagNumber.toString();\r\n        }\r\n    };\r\n\r\n    content(maxLength?) { \r\n        if (this.tag === undefined)\r\n            return null;\r\n        if (maxLength === undefined)\r\n            maxLength = Infinity;\r\n        var content = this.posContent(),\r\n            len = Math.abs(this.length);\r\n        if (!this.tag.isUniversal()) {\r\n            if (this.sub !== null)\r\n                return \"(\" + this.sub.length + \" elem)\";\r\n            return this.stream.parseOctetString(content, content + len, maxLength);\r\n        }\r\n        switch (this.tag.tagNumber) {\r\n            case 0x01: \r\n                return (this.stream.get(content) === 0) ? \"false\" : \"true\";\r\n            case 0x02: \r\n                return this.stream.parseInteger(content, content + len);\r\n            case 0x03: \r\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\r\n                    this.stream.parseBitString(content, content + len, maxLength);\r\n            case 0x04: \r\n                return this.sub ? \"(\" + this.sub.length + \" elem)\" :\r\n                    this.stream.parseOctetString(content, content + len, maxLength);\r\n            \r\n            case 0x06: \r\n                return this.stream.parseOID(content, content + len, maxLength);\r\n            \r\n            \r\n            \r\n            \r\n            \r\n            case 0x10: \r\n            case 0x11: \r\n                if (this.sub !== null)\r\n                    return \"(\" + this.sub.length + \" elem)\";\r\n                else\r\n                    return \"(no elem)\";\r\n            case 0x0C: \r\n                return stringCut(this.stream.parseStringUTF(content, content + len), maxLength);\r\n            case 0x12: \r\n            case 0x13: \r\n            case 0x14: \r\n            case 0x15: \r\n            case 0x16: \r\n            \r\n            case 0x1A: \r\n                \r\n                \r\n                return stringCut(this.stream.parseStringISO(content, content + len), maxLength);\r\n            case 0x1E: \r\n                return stringCut(this.stream.parseStringBMP(content, content + len), maxLength);\r\n            case 0x17: \r\n            case 0x18: \r\n                return this.stream.parseTime(content, content + len, (this.tag.tagNumber == 0x17));\r\n        }\r\n        return null;\r\n    };\r\n\r\n    toString() {\r\n        return this.typeName() + \"@\" + this.stream.pos + \"[header:\" + this.header + \",length:\" + this.length + \",sub:\" + ((this.sub === null) ? 'null' : this.sub.length) + \"]\";\r\n    };\r\n\r\n    posStart() {\r\n        return this.stream.pos;\r\n    };\r\n\r\n    posContent() {\r\n        return this.stream.pos + this.header;\r\n    };\r\n\r\n    posEnd() {\r\n        return this.stream.pos + this.header + Math.abs(this.length);\r\n    };\r\n\r\n    toHexString(root?) {\r\n        return this.stream.hexDump(this.posStart(), this.posEnd(), true);\r\n    };\r\n\r\n    getHex() {\r\n        return this.stream.hexDump(this.posContent(), this.posEnd(), true);\r\n    };\r\n\r\n    getAB(clean = true) {\r\n        return clean ? cleanZeros(hex2AB(this.getHex())) : hex2AB(this.getHex());\r\n    };\r\n\r\n    static decodeLength(stream) {\r\n        let buf = stream.get();\r\n        const len = buf & 0x7F;\r\n        if (len == buf)\r\n            return len;\r\n        if (len > 6)\r\n            throw \"Length over 48 bits not supported at position \" + (stream.pos - 1);\r\n        if (len === 0)\r\n            return null; \r\n        buf = 0;\r\n        for (var i = 0; i < len; ++i)\r\n            buf = (buf * 256) + stream.get();\r\n        return buf;\r\n    };\r\n\r\n    static decode(stream) {\r\n        if (!(stream instanceof Stream))\r\n            stream = new Stream(stream, 0);\r\n        const streamStart = new Stream(stream);\r\n        const tag = new ASN1Tag(stream);\r\n        let len = ASN1.decodeLength(stream), sub: any = null;\r\n        const start = stream.pos;\r\n        const header = start - streamStart.pos;\r\n        const getSub = function () {\r\n            sub = [];\r\n            if (len !== null) {\r\n                var end = start + len;\r\n                while (stream.pos < end)\r\n                    sub[sub.length] = ASN1.decode(stream);\r\n                if (stream.pos != end)\r\n                    throw \"Content size is not correct for container starting at offset \" + start;\r\n            } else {\r\n                try {\r\n                    for (; ;) {\r\n                        const s = ASN1.decode(stream);\r\n                        if (s.tag.isEOC())\r\n                            break;\r\n                        sub[sub.length] = s;\r\n                    }\r\n                    len = start - stream.pos; \r\n                } catch (e) {\r\n                    throw \"Exception while decoding undefined length content: \" + e;\r\n                }\r\n            }\r\n        };\r\n        if (tag.tagConstructed) {\r\n            getSub();\r\n        } else if (tag.isUniversal() && ((tag.tagNumber == 0x03) || (tag.tagNumber == 0x04))) {\r\n            try {\r\n                if (tag.tagNumber == 0x03)\r\n                    if (stream.get() != 0)\r\n                        throw \"BIT STRINGs with unused bits cannot encapsulate.\";\r\n                getSub();\r\n                for (var i = 0; i < sub.length; ++i)\r\n                    if (sub[i].tag.isEOC())\r\n                        throw 'EOC is not supposed to be actual content.';\r\n            } catch (e) {\r\n                \r\n                sub = null;\r\n            }\r\n        }\r\n        if (sub === null) {\r\n            if (len === null)\r\n                throw \"We can't skip over an invalid tag with undefined length at offset \" + start;\r\n            stream.pos = start + Math.abs(len);\r\n        }\r\n        return new ASN1(streamStart, header, len, tag, sub);\r\n    };\r\n}\r\n\r\nclass ASN1Tag {\r\n    tagClass: any;\r\n    tagConstructed: any;\r\n    tagNumber: any;\r\n\r\n    constructor(stream) {\r\n        var buf = stream.get();\r\n        this.tagClass = buf >> 6;\r\n        this.tagConstructed = ((buf & 0x20) !== 0);\r\n        this.tagNumber = buf & 0x1F;\r\n        if (this.tagNumber == 0x1F) { \r\n            var n = new Int10();\r\n            do {\r\n                buf = stream.get();\r\n                n.mulAdd(128, buf & 0x7F);\r\n            } while (buf & 0x80);\r\n            this.tagNumber = n.simplify();\r\n        }\r\n    }\r\n\r\n    isUniversal() {\r\n        return this.tagClass === 0x00;\r\n    };\r\n\r\n    isEOC() {\r\n        return this.tagClass === 0x00 && this.tagNumber === 0x00;\r\n    };\r\n}\r\n","import pako from \"pako\";\r\n/* Issue3: Works, but ASN1 adds 14kb of code to this lib\r\nimport ASN1 from \"asn1js\";\r\n*/\r\n// Simplified/improved version of\r\n// \"asn1js\": \"git+https://github.com/lapo-luchini/asn1js.git\",\r\nimport { ASN1 } from \"./asn1\";\r\nimport {\r\n    AB2hex,\r\n    cleanZeros,\r\n    CRYPTO_NOT_FOUND,\r\n    generateErrorMessage,\r\n    hex2AB,\r\n    ILLEGAL_ARGUMENT,\r\n    num2hex,\r\n    PAKO_NOT_FOUND,\r\n    UNSUPPORTED_ALGORITHM\r\n} from \"./util\";\r\n/*\r\n//crypto-browserify:\r\nimport { createHmac, createSign, createVerify } from \"crypto-browserify\";\r\n//or browserify hmac/sign\r\nimport { createHmac } from \"create-hmac\";\r\nimport { createSign, createVerify } from \"browserify-sign\";\r\n\r\n//node.js\r\nimport { createHmac, createSign, createVerify } from \"crypto\";\r\n*/\r\nexport const webCrypto = typeof window === \"object\" && (window.crypto || window['msCrypto']);\r\nexport const webCryptoSubtle = webCrypto && (webCrypto.subtle || webCrypto['webkitSubtle'] || webCrypto['Subtle']);\r\n\r\n/**\r\n * Pako 1.0.6 has 'from' property which is not included in current version of typeDef @types/pako@1.0.0\r\n *\r\n * @hidden\r\n */\r\ndeclare namespace Pako {\r\n    export interface DeflateOptions {\r\n        raw?: boolean;\r\n        from?: string;\r\n        to?: string;\r\n    }\r\n\r\n    export interface InflateOptions {\r\n        raw?: boolean;\r\n        from?: string;\r\n        to?: string;\r\n    }\r\n}\r\n\r\n/**\r\n * Class for creating a JwtSplit object with three parts of JWT Token as strings\r\n *\r\n * @class  JwtSplit\r\n */\r\nexport class JwtSplit {\r\n    /**\r\n     * Header (first) part of JWT Token\r\n     *\r\n     * @name  header\r\n     * @type {string}\r\n     */\r\n    header: string;\r\n\r\n    /**\r\n     * Payload (second) part of JWT Token\r\n     *\r\n     * @name  payload\r\n     * @type {string}\r\n     */\r\n    payload: string;\r\n\r\n    /**\r\n     * Signature (third) part of JWT Token\r\n     *\r\n     * @name  signature\r\n     * @type {string}\r\n     */\r\n    signature: string;\r\n\r\n    constructor(str: string, callee = 'JwtSplit') {\r\n        if (typeof str !== 'string') {\r\n            throw new Error(generateErrorMessage(str, callee, 'JWT string'));\r\n        }\r\n\r\n        const jwtArr = str.split('.');\r\n        if (jwtArr.length !== 3) {\r\n            throw new Error(generateErrorMessage(str, callee, 'JWT string'));\r\n        }\r\n\r\n        const [header, payload, signature] = jwtArr;\r\n        this.header = header;\r\n        this.payload = payload;\r\n        this.signature = signature;\r\n    }\r\n\r\n    public toString(): string {\r\n        return this.header + '.' + this.payload + '.' + this.signature\r\n    }\r\n}\r\n\r\n/** JwtPart interface basically object type definition used as a placeholder */\r\ninterface JwtPart {\r\n    [key: string]: any\r\n}\r\n\r\n/**\r\n * Class for creating a JwtDecode object with three parts of JWT Token, header and payload decoded and parsed, signature in initial form\r\n *\r\n * @class  JwtDecode\r\n */\r\nexport class JwtDecode {\r\n    /**\r\n     * Header (first) part of JWT Token\r\n     *\r\n     * @name  header\r\n     * @type {JwtPart}\r\n     */\r\n    public header: JwtPart = {};\r\n\r\n    /**\r\n     * Payload (second) part of JWT Token\r\n     *\r\n     * @name  payload\r\n     * @type {JwtPart}\r\n     */\r\n    public payload: JwtPart = {};\r\n\r\n    /**\r\n     * Signature (third) part of JWT Token\r\n     *\r\n     * @name  signature\r\n     * @type {string}\r\n     */\r\n    public signature: string = '';\r\n\r\n    constructor(str: string, callee = 'JwtDecode') {\r\n        if (typeof str !== 'string') {\r\n            throw new Error(generateErrorMessage(str, callee, 'JWT string'));\r\n        }\r\n        const jwtObj: JwtSplit = jwtSplit(str, callee);\r\n        if (jwtObj) {\r\n            this.header = jwtObj.header ? s2J(bu2s(jwtObj.header)) : {};\r\n            this.payload = jwtObj.payload ? (isGzip(this.header) ? s2J(zbu2s(jwtObj.payload)) : s2J(bu2s(jwtObj.payload))) : {};\r\n            this.signature = jwtObj.signature || '';\r\n        }\r\n    }\r\n\r\n    public toString(): string {\r\n        return s2bu(J2s(this.header)) + '.' + (isGzip(this.header) ? s2zbu(J2s(this.payload)) : s2bu(J2s(this.payload))) + '.' + this.signature\r\n    }\r\n}\r\n\r\n/**\r\n * Try running function and replace it's response as Promise.resolve/reject\r\n *\r\n * @param {function} fn - fn to call in for response\r\n *\r\n * @returns {Promise<any>} resulting Promise\r\n */\r\nexport function tryPromise(fn) {\r\n    try {\r\n        return Promise.resolve(fn());\r\n    } catch (e) {\r\n        return Promise.reject(e);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts string to JSON object\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {object} resulting object\r\n */\r\nexport function s2J(str: string): any {\r\n    try {\r\n        return JSON.parse(str);\r\n    } catch (e) {\r\n        throw new Error(e.message);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts JSON object to string\r\n *\r\n * @param {object} obj - JSON object to convert\r\n *\r\n * @returns {string} resulting string\r\n */\r\nexport function J2s(obj: any): string {\r\n    try {\r\n        return JSON.stringify(obj);\r\n    } catch (e) {\r\n        throw new Error(e.message);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts string to base64 string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} decoded data string\r\n */\r\nexport function b2s(str: string): string {\r\n    try {\r\n        if (typeof window === 'object' && typeof window.atob === 'function') {\r\n            return window.atob(str);\r\n        } else if (typeof Buffer !== 'undefined') {\r\n            return Buffer.from(str, 'base64').toString('binary')\r\n        } else throw new Error(ILLEGAL_ARGUMENT);\r\n    } catch (e) {\r\n        throw new Error(e);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts base64 string to base64url string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} base64url string\r\n */\r\nexport function b2bu(str: string): string {\r\n    if ((typeof str !== 'string') || (str.length % 4 !== 0)) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n\r\n    return str\r\n        .replace(/\\+/g, '-')\r\n        .replace(/\\//g, '_')\r\n        .replace(/=/g, '');\r\n}\r\n\r\n/**\r\n *\r\n * Converts base64url string to base64 string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} base64 string\r\n */\r\nexport function bu2b(str: string): string {\r\n    if ((typeof str !== 'string') || (str.length % 4 === 1)) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n\r\n    for (; (str.length % 4 !== 0);) {\r\n        str += '=';\r\n    }\r\n    return str\r\n        .replace(/\\-/g, '+')\r\n        .replace(/_/g, '/');\r\n}\r\n\r\n/**\r\n * Converts base64url string to string\r\n *\r\n * @param {string} str - base64url string to convert\r\n *\r\n * @returns {string} decoded data string\r\n */\r\nexport function bu2s(str: string): string {\r\n    return b2s(bu2b(str));\r\n}\r\n\r\n/**\r\n * Check if header has zip property (and it is equal to 'GZIP', ignorecase)\r\n *\r\n * @param {string} header - object to check\r\n *\r\n * @returns {boolean} does it have gzip in zip property\r\n */\r\nexport function isGzip(header: JwtPart): boolean {\r\n    return typeof header === 'object' && typeof header.zip === 'string' && header.zip.toUpperCase() === 'GZIP'\r\n}\r\n\r\n/**\r\n * Decode jwtToken header and payload\r\n *\r\n * @param {string} str - data string to decode\r\n *\r\n * @returns {JwtDecode} object with decoded header and body, and signature untouched\r\n */\r\nexport function jwtDecode(str: string, callee = 'jwtDecode'): JwtDecode {\r\n    return new JwtDecode(str, callee);\r\n}\r\n\r\n/**\r\n * Split jwtToken into object {header, payload, signature}\r\n *\r\n * @param {string} str - data string to split\r\n *\r\n * @returns {JwtSplit} jwt split object of three strings\r\n */\r\nexport function jwtSplit(str: string, callee = 'jwtSplit'): JwtSplit {\r\n    return new JwtSplit(str, callee);\r\n}\r\n\r\nexport const splitJwt = jwtSplit;\r\n\r\n/**\r\n * Converts base64 string to string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} base64 string\r\n */\r\nexport function s2b(str: string): string {\r\n    try {\r\n        if (typeof window === 'object' && typeof window.atob === 'function') {\r\n            return window.btoa(str);\r\n        } else if (typeof Buffer !== 'undefined') {\r\n            return Buffer.from(str).toString('base64');\r\n        } else throw new Error(ILLEGAL_ARGUMENT);\r\n    } catch (e) {\r\n        throw new Error(e);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts string to base64url string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} base64url string\r\n */\r\nexport function s2bu(str: string): string {\r\n    return b2bu(s2b(str));\r\n}\r\n\r\n/**\r\n * Gzip and encode data string to base64url string\r\n *\r\n * @param {string} str - data string to encode\r\n *\r\n * @returns {string} base64url string\r\n */\r\nexport function s2zbu(str: string): string {\r\n    return s2bu(zip(str));\r\n}\r\n\r\n/**\r\n * Converts from gzip data string to string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} decoded data string\r\n */\r\nexport function unzip(str: string): string {\r\n    if (typeof str !== 'string') {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n\r\n    if (!!pako && pako.inflate) {\r\n        return pako.inflate(str, {\r\n            raw: false,\r\n            from: 'string',\r\n            to: 'string'\r\n        } as Pako.InflateOptions & { to: 'string' });\r\n    } else {\r\n        throw new Error(PAKO_NOT_FOUND);\r\n    }\r\n}\r\n\r\n/**\r\n * Decode from base64url and unzip data string\r\n *\r\n * @param {string} str - data string to decode\r\n *\r\n * @returns {string} decoded data string\r\n */\r\nexport function zbu2s(str: string): string {\r\n    return unzip(bu2s(str));\r\n}\r\n\r\n/**\r\n * Converts string to gzip data string\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {string} gzip data string\r\n */\r\nexport function zip(str: string): string {\r\n    if (typeof str !== 'string') {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n\r\n    if (!!pako && pako.deflate) {\r\n        return pako.deflate(str, {\r\n            raw: false,\r\n            from: 'string',\r\n            to: 'string'\r\n        } as Pako.DeflateOptions & { to: 'string' });\r\n    } else {\r\n        throw new Error(PAKO_NOT_FOUND);\r\n    }\r\n}\r\n\r\n/**\r\n * Converts string to ArrayBuffer\r\n *\r\n * @param {string} str - data string to convert\r\n *\r\n * @returns {ArrayBuffer | Uint8Array} charCode ArrayBuffer\r\n */\r\nexport function s2AB(str: string): ArrayBuffer | Uint8Array {\r\n    const buff = new Uint8Array(str.length);\r\n    for (let i = 0; i < str.length; i++) buff[i] = str.charCodeAt(i);\r\n    return buff;\r\n}\r\n\r\n/**\r\n * Converts ArrayBuffer to string\r\n *\r\n * @param {ArrayBuffer | Uint8Array} buff - charCode ArrayBuffer to convert\r\n *\r\n * @returns {string} data string\r\n */\r\nexport function AB2s(buff: ArrayBuffer | Uint8Array): string {\r\n    if (buff instanceof ArrayBuffer) buff = new Uint8Array(buff);\r\n    return String.fromCharCode.apply(String, Array.from(buff as Uint8Array));\r\n}\r\n\r\n/**\r\n * Async function inspired by createHmac in crypto (used WebCrypto Api supported by most browsers)\r\n *\r\n */\r\n\r\nexport async function createHmac(name: string, secret: string): Promise<any> {\r\n    if (webCryptoSubtle) {\r\n        const keyData = s2AB(secret);\r\n        return await webCryptoSubtle.importKey(\r\n            'raw',\r\n            keyData,\r\n            { name: 'HMAC', hash: { name: name } },\r\n            true,\r\n            ['sign']\r\n        ).then(key => {\r\n            return {\r\n                update: async function (thing): Promise<ArrayBuffer> {\r\n                    return await webCryptoSubtle.sign(\r\n                        'HMAC',\r\n                        key,\r\n                        s2AB(thing)\r\n                    )\r\n                }\r\n            }\r\n        })\r\n    } else {\r\n        const crypto = await import(\"crypto\");\r\n        return !!crypto && crypto.createHmac ? Promise.resolve(crypto.createHmac(name.replace('SHA-', 'sha'), secret)) : Promise.reject(webCrypto);\r\n    }\r\n}\r\n\r\n/**\r\n * Algorithm HMAC sign generator\r\n *\r\n */\r\nexport function algHSsign(bits: number) {\r\n    /**\r\n     * Algorithm HMAC signer\r\n     *\r\n     */\r\n    return async function sign(thing: string, secret: string): Promise<string> {\r\n        const hmac = await createHmac('SHA-' + bits, secret);\r\n        return Promise.resolve(webCryptoSubtle ? s2bu(AB2s(hmac && await hmac.update(thing))) : b2bu(hmac && hmac.update(thing).digest('base64')));\r\n    }\r\n}\r\n\r\n/**\r\n * Algorithm HMAC verify generator\r\n *\r\n */\r\nexport function algHSverify(bits: number) {\r\n    /**\r\n     * Algorithm HMAC verifier\r\n     *\r\n     */\r\n    return async function verify(thing: string, signature: string, secret: string): Promise<boolean> {\r\n        return await algHSsign(bits)(thing, secret) === signature;\r\n    }\r\n}\r\n\r\nexport interface PEM {\r\n    body: ArrayBuffer | Uint8Array,\r\n    type: 'private' | 'public'\r\n}\r\n\r\nexport function s2pem(secret: string): PEM {\r\n    if (typeof secret !== 'string') {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n    let type = 'public';\r\n\r\n    function ignore(line: string): boolean {\r\n        if (ignoreLinesPriv.some(ign => line.toUpperCase().indexOf(ign) > -1)) {\r\n            type = 'private';\r\n            return false;\r\n        }\r\n        return !ignoreLinesPub.some(ign => line.toUpperCase().indexOf(ign) > -1);\r\n    }\r\n\r\n    const lines = secret.split('\\n'),\r\n        ignoreLinesPriv = [\r\n            '-BEGIN RSA PRIVATE KEY-',\r\n            '-END RSA PRIVATE KEY-'],\r\n        ignoreLinesPub = [\r\n            '-BEGIN RSA PUBLIC KEY-',\r\n            '-BEGIN PUBLIC KEY-',\r\n            '-END PUBLIC KEY-',\r\n            '-END RSA PUBLIC KEY-'\r\n        ], body = lines.map(line => line.trim()).filter(line =>\r\n        line.length && ignore(line)).join('');\r\n    if (body.length) {\r\n        return { body: s2AB(b2s(bu2b(body))), type: <'private' | 'public'>type };\r\n    } else {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n}\r\n\r\n/* Issue2: not universal does not work with structured PEM keys\r\nexport function pem2asn1(buff: ArrayBuffer | Uint8Array, type: 'private' | 'public'): any {\r\n    if (!buff || !type) throw new Error(ILLEGAL_ARGUMENT);\r\n    if (buff instanceof ArrayBuffer) buff = new Uint8Array(buff);\r\n    let data = new DataView(buff.buffer);\r\n\r\n    let res = {};\r\n    let offset = {\r\n        private: buff[1] & 0x80 ? buff[1] - 0x80 + 5 : 7,\r\n        public: buff[1] & 0x80 ? buff[1] - 0x80 + 2 : 2,\r\n    }[type.toLowerCase()];\r\n\r\n    function read() {\r\n        if ((offset + 1) < buff.byteLength) {\r\n            let s = data.getUint8(offset + 1);\r\n            if (s & 0x80) {\r\n                let n = s - 0x80;\r\n                s = data[[\r\n                    'getUint8', 'getInt16'\r\n                ][n - 1]](offset + 2, false);\r\n                offset += n;\r\n            }\r\n            offset += 2;\r\n            let b = (<Uint8Array>buff).slice(offset, offset + s);\r\n            offset += s;\r\n            return cleanZeros(b);\r\n        }\r\n        return new Uint8Array();\r\n    }\r\n\r\n    res['modulus'] = read();\r\n    res['bits'] = (res['modulus'].length - 1) * 8 + Math.ceil(\r\n        Math.log(res['modulus'][0] + 1) / Math.log(2)\r\n    );\r\n    if (!res['bits']) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n    res['publicExponent'] = parseInt(AB2hex(read()), 16);\r\n    if (type === 'private') {\r\n        res['privateExponent'] = read();\r\n        res['prime1'] = read();\r\n        res['prime2'] = read();\r\n        res['exponent1'] = read();\r\n        res['exponent2'] = read();\r\n        res['coefficient'] = read();\r\n    }\r\n    return res;\r\n}\r\n\r\nexport function asn12jwk(asn1: any, type: string, extra?: any): any {\r\n    const pemTypes = ['public', 'private'];\r\n    if (!asn1) throw new Error(ILLEGAL_ARGUMENT);\r\n\r\n    type = ((typeof type === 'string') && type.toLowerCase())\r\n        || pemTypes[!!asn1.privateExponent ? 1 : 0];\r\n    if ((type === 'private' && !asn1.privateExponent)\r\n        || pemTypes.indexOf(type) < 0) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n    let v = asn1.publicExponent;\r\n    const expSize = Math.ceil(Math.log(v) / Math.log(256));\r\n    const exp = new Uint8Array(expSize).map(function (el) {\r\n        el = v % 256;\r\n        v = Math.floor(v / 256);\r\n        return el\r\n    }).reverse();\r\n\r\n    let jwk = Object.assign({ kty: 'RSA' }, extra, {\r\n        n: s2bu(AB2s(asn1.modulus)),\r\n        e: s2bu(AB2s(exp)),\r\n    });\r\n\r\n    if (type === 'private') {\r\n        Object.assign(jwk, {\r\n            d: s2bu(AB2s(asn1.privateExponent)),\r\n            p: s2bu(AB2s(asn1.prime1)),\r\n            q: s2bu(AB2s(asn1.prime2)),\r\n            dp: s2bu(AB2s(asn1.exponent1)),\r\n            dq: s2bu(AB2s(asn1.exponent2)),\r\n            qi: s2bu(AB2s(asn1.coefficient))\r\n        });\r\n    }\r\n    return jwk;\r\n}\r\n*/\r\n\r\n/* Issue3: Works, but ASN1 adds 14kb of code to this lib\r\nASN1.prototype.getAB = function() {\r\n    return cleanZeros(hex2AB(this.getHex()));\r\n};\r\n\r\nexport function pem2asn1(buff: ArrayBuffer | Uint8Array): any {\r\n    if (!buff) throw new Error(ILLEGAL_ARGUMENT);\r\n    if (buff instanceof ArrayBuffer) buff = new Uint8Array(buff);\r\n    let asn1 = ASN1.decode(buff), res = {};\r\n\r\n    // add different PEM key structures and use sub.structure for ordering\r\n    if (asn1.sub.length === 3) {\r\n        asn1 = asn1.sub[2].sub[0];\r\n    }\r\n    if (asn1.sub.length === 9) {\r\n        // Parse the private key.\r\n        res['modulus'] = asn1.sub[1].getAB(); // ArrayBuffer\r\n        res['publicExponent'] = parseInt(asn1.sub[2].getHex(), 16); // int\r\n        res['privateExponent'] = asn1.sub[3].getAB(); // ArrayBuffer\r\n        res['prime1'] = asn1.sub[4].getAB(); // ArrayBuffer\r\n        res['prime2'] = asn1.sub[5].getAB(); // ArrayBuffer\r\n        res['exponent1'] = asn1.sub[6].getAB(); // ArrayBuffer\r\n        res['exponent2'] = asn1.sub[7].getAB(); // ArrayBuffer\r\n        res['coefficient'] = asn1.sub[8].getAB(); // ArrayBuffer\r\n\r\n    } else if (asn1.sub.length === 2) {\r\n        // Parse the public key.\r\n        asn1 = asn1.sub[1].sub[0];\r\n\r\n        res['modulus'] = asn1.sub[0].getAB(); // ArrayBuffer\r\n        res['publicExponent'] = parseInt(asn1.sub[1].getHex(), 16); // int\r\n    }\r\n    return res;\r\n}\r\n*/\r\nexport class Asn1Tag {\r\n    tagClass: number = 0;\r\n    tagConstructed: boolean = false;\r\n    tagNumber: number = 0;\r\n\r\n    constructor(stream) {\r\n        const buf = stream.read();\r\n        this.tagClass = buf >> 6;\r\n        this.tagConstructed = ((buf & 0x20) !== 0);\r\n        this.tagNumber = buf & 0x1F;\r\n    }\r\n}\r\n\r\nexport function pem2asn1(buff: ArrayBuffer | Uint8Array): any {\r\n    if (!buff) throw new Error(ILLEGAL_ARGUMENT);\r\n\r\n    if (buff instanceof ArrayBuffer) buff = new Uint8Array(buff);\r\n    let asn1 = ASN1.decode(buff), res = {};\r\n\r\n    if (asn1.sub.length === 3) {\r\n        asn1 = asn1.sub[2].sub[0];\r\n    }\r\n    if (asn1.sub.length === 9) {\r\n        // Parse the private key.\r\n        res['modulus'] = asn1.sub[1].getAB(); // ArrayBuffer\r\n        res['publicExponent'] = parseInt(asn1.sub[2].getHex(), 16); // int\r\n        res['privateExponent'] = asn1.sub[3].getAB(); // ArrayBuffer\r\n        res['prime1'] = asn1.sub[4].getAB(); // ArrayBuffer\r\n        res['prime2'] = asn1.sub[5].getAB(); // ArrayBuffer\r\n        res['exponent1'] = asn1.sub[6].getAB(); // ArrayBuffer\r\n        res['exponent2'] = asn1.sub[7].getAB(); // ArrayBuffer\r\n        res['coefficient'] = asn1.sub[8].getAB(); // ArrayBuffer\r\n    } else if (asn1.sub.length === 2) {\r\n        // Parse the public key.\r\n        asn1 = asn1.sub[1].sub[0];\r\n\r\n        res['modulus'] = asn1.sub[0].getAB(); // ArrayBuffer\r\n        res['publicExponent'] = parseInt(asn1.sub[1].getHex(), 16); // int\r\n    }\r\n\r\n    res['bits'] = (res['modulus'].length - 1) * 8 + Math.ceil(\r\n        Math.log(res['modulus'][0] + 1) / Math.log(2)\r\n    );\r\n\r\n    if (!res['bits']) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n\r\n    return res;\r\n}\r\n\r\nexport function asn12jwk(asn1: any, type?: string, extra?: any): any {\r\n    const pemTypes = ['public', 'private'];\r\n    if (!asn1) throw new Error(ILLEGAL_ARGUMENT);\r\n\r\n    type = ((typeof type === 'string') && type.toLowerCase())\r\n        || pemTypes[!!asn1.privateExponent ? 1 : 0];\r\n\r\n    if (type === 'private' && !asn1.privateExponent) {\r\n        throw new Error(ILLEGAL_ARGUMENT);\r\n    }\r\n    let v = asn1.publicExponent;\r\n    const expSize = Math.ceil(Math.log(v) / Math.log(256));\r\n    const exp = new Uint8Array(expSize).map(function (el) {\r\n        el = v % 256;\r\n        v = Math.floor(v / 256);\r\n        return el\r\n    }).reverse();\r\n\r\n    let jwk = Object.assign({ kty: 'RSA' }, extra, {\r\n        n: s2bu(AB2s(asn1.modulus)),\r\n        e: s2bu(AB2s(exp)),\r\n    });\r\n\r\n    if (type === 'private') {\r\n        Object.assign(jwk, {\r\n            d: s2bu(AB2s(asn1.privateExponent)),\r\n            p: s2bu(AB2s(asn1.prime1)),\r\n            q: s2bu(AB2s(asn1.prime2)),\r\n            dp: s2bu(AB2s(asn1.exponent1)),\r\n            dq: s2bu(AB2s(asn1.exponent2)),\r\n            qi: s2bu(AB2s(asn1.coefficient))\r\n        });\r\n    }\r\n    return jwk;\r\n}\r\n\r\nexport function pem2jwk(secret: string, type?: \"public\" | \"private\", extra?): Promise<any> {\r\n    return tryPromise(() => {\r\n        const pem = s2pem(secret);\r\n        return asn12jwk(pem2asn1(pem.body), type, extra)\r\n    })\r\n}\r\n\r\n/* Issue1: does not work with all versions of PEM keys...\r\nexport function parsePem(secret: string, concType?: \"public\" | \"private\", extra?): Promise<PEM> {\r\n    return tryPromise(() => {\r\n            const pem = s2pem(secret);\r\n            if (!concType) concType = pem.type;\r\n            if (concType !== pem.type) throw new Error(ILLEGAL_ARGUMENT);\r\n            return pem\r\n        })\r\n}\r\n*/\r\n\r\nexport async function createSign(name: string): Promise<any> {\r\n    if (webCryptoSubtle) {\r\n        return {\r\n            update: function (thing: string): any {\r\n                return {\r\n                    sign: async function (secret: string, encoding: string): Promise<any> {\r\n                        return await pem2jwk(secret, 'private', {\r\n                            key_ops: ['sign'],\r\n                            alg: name.replace('SHA-', 'RS')\r\n                        }).then(async keyData => {\r\n                            return await webCryptoSubtle.importKey(\r\n                                'jwk',\r\n                                keyData,\r\n                                { name: 'RSASSA-PKCS1-v1_5', hash: { name: name } },\r\n                                true,\r\n                                ['sign']\r\n                            ).then(async key => {\r\n                                return await webCryptoSubtle.sign(\r\n                                    { name: 'RSASSA-PKCS1-v1_5', hash: { name: name } },\r\n                                    key,\r\n                                    s2AB(thing)\r\n                                ).then(AB2s).then(s2b)\r\n                            })\r\n                        });\r\n\r\n                        /* Issue1: does not work with all versions of PEM keys...\r\n                        return await parsePem(secret, 'private').then(async pem => {\r\n                            return await webCryptoSubtle.importKey(\r\n                                'pkcs8',\r\n                                pem.body,\r\n                                { name: 'RSASSA-PKCS1-v1_5', hash: { name: name } },\r\n                                true,\r\n                                ['sign']\r\n                            ).then(async key => {\r\n                                return await webCryptoSubtle.sign(\r\n                                    'RSASSA-PKCS1-v1_5',\r\n                                    key,\r\n                                    s2AB(thing)\r\n                                ).then(AB2s).then(s2b)\r\n                            })\r\n                        })\r\n                        */\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        const crypto = await import(\"crypto\");\r\n        if (!!crypto && crypto.createSign) {\r\n            return crypto.createSign(name.replace('SHA-', 'RSA-SHA'))\r\n        } else {\r\n            throw new Error(CRYPTO_NOT_FOUND);\r\n        }\r\n    }\r\n}\r\n\r\nexport function algRSsign(bits: number) {\r\n    return async function sign(thing: string, privateKey: string): Promise<string> {\r\n        try {\r\n            const res = await createSign('SHA-' + bits);\r\n            return b2bu(await res.update(thing).sign(privateKey, 'base64'));\r\n        } catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n}\r\n\r\nexport async function createVerify(name: string): Promise<any> {\r\n    if (webCryptoSubtle) {\r\n        return {\r\n            update: function (thing: string): any {\r\n                return {\r\n                    verify: async function (secret: string, signature: string, encoding: string): Promise<boolean> {\r\n                        return await pem2jwk(secret, 'public', {\r\n                            key_ops: ['verify'],\r\n                            alg: name.replace('SHA-', 'RS')\r\n                        }).then(async ({ kty, n, e }) => {\r\n                            return await webCryptoSubtle.importKey(\r\n                                'jwk',\r\n                                { kty, n, e },\r\n                                { name: 'RSASSA-PKCS1-v1_5', hash: { name: name } },\r\n                                false,\r\n                                ['verify']\r\n                            ).then(async key => {\r\n                                return await webCryptoSubtle.verify(\r\n                                    'RSASSA-PKCS1-v1_5',\r\n                                    key,\r\n                                    s2AB(bu2s(signature)),\r\n                                    s2AB(thing)\r\n                                )\r\n                            })\r\n                        });\r\n                        /* Issue1: does not work with all versions of PEM keys...\r\n                        return await parsePem(secret, 'public').then(async pem => {\r\n                            return await webCryptoSubtle.importKey(\r\n                                'spki',\r\n                                pem.body,\r\n                                { name: 'RSASSA-PKCS1-v1_5', hash: { name: name } },\r\n                                true,\r\n                                ['verify']\r\n                            ).then(async key => {\r\n                                return await webCryptoSubtle.verify(\r\n                                    'RSASSA-PKCS1-v1_5',\r\n                                    key,\r\n                                    s2AB(bu2s(signature)),\r\n                                    s2AB(thing)\r\n                                )\r\n                            })\r\n                        })*/\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        const crypto = await import(\"crypto\");\r\n        if (!!crypto && crypto.createVerify) {\r\n            return crypto.createVerify(name.replace('SHA-', 'RSA-SHA'))\r\n        } else {\r\n            throw new Error(CRYPTO_NOT_FOUND);\r\n        }\r\n    }\r\n}\r\n\r\nexport function algRSverify(bits: number) {\r\n    return async function verify(thing: string, signature: string, publicKey: string): Promise<boolean> {\r\n        try {\r\n            signature = bu2b(signature);\r\n            const rsaVerify = await createVerify('SHA-' + bits);\r\n            return await rsaVerify.update(thing).verify(publicKey, signature, 'base64');\r\n        } catch (e) {\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Universal algorithm verifier\r\n *\r\n */\r\nexport async function algVerify(algorithm: string, thing: string, signature: string, secret: string): Promise<boolean> {\r\n    if (typeof algorithm !== 'string' || algorithm.length < 4) {\r\n        throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n    const algo = algorithm.toLowerCase();\r\n\r\n    if (algo === 'none') {\r\n        return signature === '';\r\n    }\r\n\r\n    const type = algo.slice(0, 2), bits = parseInt(algo.slice(2));\r\n    if (isNaN(bits) || ([256, 384, 512].indexOf(bits) < 0)) {\r\n        throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n\r\n    switch (type) {\r\n        case 'rs':\r\n            return await algRSverify(bits)(thing, signature, secret);\r\n        case 'hs':\r\n            return await algHSverify(bits)(thing, signature, secret);\r\n        default:\r\n            throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n}\r\n\r\n/**\r\n * Universal algorithm signer\r\n *\r\n */\r\nexport async function algSign(algorithm: string, thing: string, secret: string): Promise<string> {\r\n    if (typeof algorithm !== 'string' || algorithm.length < 4) {\r\n        throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n    const algo = algorithm.toLowerCase();\r\n\r\n    if (algo === 'none') {\r\n        return '';\r\n    }\r\n\r\n    const type = algo.slice(0, 2), bits = parseInt(algo.slice(2));\r\n    if (isNaN(bits) || ([256, 384, 512].indexOf(bits) < 0)) {\r\n        throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n\r\n    switch (type) {\r\n        case 'rs':\r\n            return await algRSsign(bits)(thing, secret);\r\n        case 'hs':\r\n            return await algHSsign(bits)(thing, secret);\r\n        default:\r\n            throw new Error(UNSUPPORTED_ALGORITHM);\r\n    }\r\n}\r\n\r\nexport async function jwtVerify(jwtStr: string, secret: string): Promise<boolean> {\r\n    const jwt = jwtSplit(jwtStr, 'jwtVerify'),\r\n        header = s2J(bu2s(jwt.header)),\r\n        thing = jwt.header + '.' + jwt.payload;\r\n    return tryPromise(() => algVerify(header.alg, thing, jwt.signature, secret));\r\n}\r\n\r\nexport const verifyJwt = jwtVerify;\r\n\r\nexport function jwtSign(jwtStr: string, secret: string): Promise<string> {\r\n    const jwt = jwtSplit(jwtStr, 'jwtSign'),\r\n        header = s2J(bu2s(jwt.header)),\r\n        thing = jwt.header + '.' + jwt.payload;\r\n    return tryPromise(async () => await algSign(header.alg, thing, secret));\r\n}\r\n\r\nexport const signJwt = jwtSign;\r\n\r\nexport async function jwtResign(jwtStr: string, secret: string, alg?: string): Promise<string> {\r\n    const jwt = jwtDecode(jwtStr, 'jwtResign');\r\n    if (!!alg) jwt.header.alg = alg;\r\n    jwt.signature = await jwtSign(jwt.toString(), secret);\r\n    return jwt.toString();\r\n}\r\n\r\nexport const resignJwt = jwtResign;\r\n\r\n/**\r\n * Used for testing only\r\n *\r\n * @hidden\r\n */\r\nexport async function cryptoType(): Promise<string> {\r\n    const crypto = await import(\"crypto\");\r\n    return crypto ? crypto['type'] || 'crypto-node' : 'undefined';\r\n}\r\n\r\nexport default {\r\n    ILLEGAL_ARGUMENT,\r\n    UNSUPPORTED_ALGORITHM,\r\n    resignJwt,\r\n    signJwt,\r\n    splitJwt,\r\n    verifyJwt,\r\n    AB2hex,\r\n    AB2s,\r\n    J2s,\r\n    algHSsign,\r\n    algHSverify,\r\n    algRSsign,\r\n    algRSverify,\r\n    algSign,\r\n    algVerify,\r\n    asn12jwk,\r\n    b2bu,\r\n    b2s,\r\n    bu2b,\r\n    bu2s,\r\n    cleanZeros,\r\n    createHmac,\r\n    createSign,\r\n    createVerify,\r\n    hex2AB,\r\n    isGzip,\r\n    jwtDecode,\r\n    jwtResign,\r\n    jwtSign,\r\n    jwtSplit,\r\n    jwtVerify,\r\n    num2hex,\r\n    pem2asn1,\r\n    pem2jwk,\r\n    s2AB,\r\n    s2J,\r\n    s2b,\r\n    s2bu,\r\n    s2pem,\r\n    s2zbu,\r\n    tryPromise,\r\n    unzip,\r\n    zbu2s,\r\n    zip,\r\n};\r\n"],"names":[],"mappings":"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"}